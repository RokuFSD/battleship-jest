var ee=Object.defineProperty;var te=(t,e,n)=>e in t?ee(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var S=(t,e,n)=>(te(t,typeof e!="symbol"?e+"":e,n),n);const ne=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&a(s)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerpolicy&&(i.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?i.credentials="include":o.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}};ne();const ie="_app_1ud87_1",oe="_modalOutter_1ud87_11",ae="_modal_1ud87_11";var M={app:ie,modalOutter:oe,modal:ae};const re="_loader_13nar_1",le="_title_13nar_14",se="_load_13nar_1";var I={loader:re,title:le,load:se};const x={carrier:5,battleship:4,destroyer:3,submarine:3,patrolboat:2},ce=t=>{let e=new Array(t).fill(0),n=Date.now();function a(i){if(e[i]===0)return e[i]=1,"hit"}function o(){return e.reduce((s,u)=>s+u,0)===t}return{id:n,length:t,hit:a,isSunk:o}};function b(t,e,n){const a=document.createElement(t);for(let o of Object.keys(e))o&&o!==""&&a.setAttribute(o,e[o]);return typeof n=="string"?a.appendChild(new Text(n)):n==null||n.forEach(o=>a.appendChild(o)),a}function N(){let t={};return function e(){let n=Math.floor(Math.random()*10),a=Math.floor(Math.random()*10);return t[`${n}${a}`]==1?e():(t[`${n}${a}`]=1,{x:n,y:a})}}function de(t,e){t.style.pointerEvents="none",setTimeout(()=>{t.style.pointerEvents="auto"},e)}const g={playerOne:{},playerTwo:{},currentPlaying:"Player",config:{mainAxis:"x",theme:"light"},setConfig:function(t){this.config={...this.config,...t}},setPlayerOne:function(t){this.playerOne=t},setPlayerTwo:function(t){this.playerTwo=t},toggleAxis:function(){this.config={...this.config,mainAxis:this.config.mainAxis==="x"?"y":"x"}}},A=(t="cpu")=>{let e={},n=t,a=N();function o(){return n}function i(c){e=c}function s(){return e}function u(){let{x:c,y:f}=a(),p=document.querySelector(`[data-cell="p${c}${f}"]`);p==null||p.dispatchEvent(new Event("click",{bubbles:!0}))}function l(){let c=Object.keys(x),f=N();for(let p of c){let y=Math.random()>.5?"x":"y",_=x[p];g.setConfig({mainAxis:y});let{x:k,y:v}=f();for(;!e.validCoordinates(k,v,_);)({x:k,y:v}=f());document.querySelector(`[data-cell="c${k}${v}"]`).dispatchEvent(new Event("click",{bubbles:!0}))}g.setConfig({mainAxis:"x"})}return{setGameboard:i,getGameboard:s,getName:o,makeAttack:u,autoplace:l}};function ue(){return new Array(10).fill(null).map(()=>Array(10).fill("empty"))}const B=()=>{let t=[],e=ue();function n(l,c){return e[l][c]==="empty"}function a(l,c,f){let p=g.config.mainAxis==="y"?l:c;for(let y=0;y<f&&p+y<=9;y++)if(g.config.mainAxis==="x"){if(!n(l,c+y))return!1}else if(!n(l+y,c))return!1;return p+f<=e.length}function o(l,c,f){let p=ce(x[f]);if(!!a(l,c,p.length)){for(let y=0;y<p.length;y++)g.config.mainAxis==="x"?e[l][c+y]={ship:p,place:y}:e[l+y][c]={ship:p,place:y};return t.push(p),"placed"}}function i(){return t.length===5}function s(l,c){if(e[l][c]==="empty")return e[l][c]="missed","misses";let{ship:f,place:p}=e[l][c];return f.hit(p),"hit"}function u(){for(let l of t)if(!l.isSunk())return!1;return!0}return{grid:e,placeShip:o,receiveAttack:s,allSunk:u,allShipsPlaced:i,validCoordinates:a}},P=(()=>{let t={},e=A("player"),n=A(),a=e;function o(_){t=_}function i(){return e}function s(){return n}function u(){e=A("player"),n=A(),a=e,g.currentPlaying="Player"}function l(){t.notify(P,"makeui")}function c(){e.setGameboard(B()),n.setGameboard(B()),g.setPlayerOne(e),g.setPlayerTwo(n),t.notify(P,"start")}function f(){return e.getGameboard().allSunk()||n.getGameboard().allSunk()}function p(_,k){if(f()){t.notify(P,"gameover");return}let v="";a.getName()!=="cpu"?(a=n,v=n.getGameboard().receiveAttack(Number(_),Number(k)),setTimeout(()=>{n.makeAttack()},1500),g.currentPlaying="Player"):(a=e,v=e.getGameboard().receiveAttack(Number(_),Number(k)),g.currentPlaying="Cpu"),t.notify(P,"turnPlayed",v)}function y(_,k,v){n.getGameboard().allShipsPlaced()?e.getGameboard().placeShip(_,k,v):n.getGameboard().placeShip(_,k,v),e.getGameboard().allShipsPlaced()&&t.notify(P,"startPlaying")}return{getPlayerOne:i,getPlayerTwo:s,start:c,handleTurn:p,makeUI:l,setMediator:o,addShip:y,reset:u}})(),me="_gridSection_14hke_1",fe="_gridContainer_14hke_9",pe="_gridContainerPlayer_14hke_10",he="_gridItem_14hke_29",ge="_misses_14hke_34",ye="_cellHover_14hke_38",ve="_cellInvalid_14hke_42",_e="_cellShip_14hke_46",$e="_glow_14hke_1",be="_hit_14hke_51",ke="_missed_14hke_55",Ce="_modal_14hke_60",Pe="_modalAxis_14hke_140";var $={gridSection:me,gridContainer:fe,gridContainerPlayer:pe,gridItem:he,misses:ge,cellHover:ye,cellInvalid:ve,cellShip:_e,glow:$e,hit:be,missed:ke,modal:Ce,"a-ltr-after":"_a-ltr-after_14hke_1","a-ltr-before":"_a-ltr-before_14hke_1",modalAxis:Pe};const H=()=>{let t=b("div",{class:`${M.modal} ${$.modal}`}),e=b("div",{class:`${M.modalOutter}`},[t]);function n(i){let s=new DocumentFragment;i.forEach(u=>s.appendChild(u)),t.appendChild(s)}function a(){return e}function o(){t.innerHTML="",e.remove()}return{addItem:n,getModal:a,closeModal:o}},q=t=>{let e=b("button",{class:`${$.btn}`},t!==""?t:"Button");function n(o,i){e.addEventListener(o,i)}function a(){return e}return{getButton:a,addEvent:n}},Ae="_notification_xkryv_1",we="_hit_xkryv_13",xe="_misses_xkryv_19";var D={notification:Ae,hit:we,misses:xe};const E=(()=>{function t(i){let s=1;function u(){if(s-=.05,s<=0){i.style.opacity="0",i.remove();return}i.style.opacity=`${s}`,requestAnimationFrame(u)}u()}function e(i){let s=window.innerHeight+window.scrollY,u=s-s*15/100,l=s*80/100,c=0;function f(){if(l+=5,c+=.2,l>=u){i.style.opacity="1",i.style.top=`${l}px`;return}i.style.opacity=`${c}`,i.style.top=`${l}px`,requestAnimationFrame(f)}f()}function n(i){if(window.matchMedia("(max-width: 768px)").matches)e(i);else{let u=function(){if(l+=1,c+=.2,l===25){i.style.opacity="1",i.style.top=`${l}%`;return}i.style.opacity=`${c}`,i.style.top=`${l}%`,requestAnimationFrame(u)},l=20,c=0;u()}}function a(i){let s=window.innerHeight+window.scrollY,u=s-s*15/100,l=s*80/100,c=1;function f(){if(u-=1,c-=.2,u<=l){i.style.opacity="0",i.style.top=`${u}px`;return}i.style.opacity=`${c}`,i.style.top=`${u}px`,requestAnimationFrame(f)}f()}function o(i){if(window.matchMedia("(max-width: 768px)").matches)a(i);else{let u=function(){if(l-=1,c-=.2,l===20){i.style.opacity="0",i.style.top=`${l}%`;return}i.style.opacity=`${c}`,i.style.top=`${l}%`,requestAnimationFrame(u)},l=25,c=1;u()}}return{closeAnimation:t,appearsAnimation:n,disappearsAnimation:o}})(),Se=(()=>{function t(e,n){const a=b("div",{class:`${D.notification} ${D[n]}`},[b("p",{},e)]);document.body.appendChild(a),E.appearsAnimation(a),setTimeout(()=>{E.disappearsAnimation(a)},1e3),setTimeout(()=>{a.remove()},1500)}return{notify:t}})(),w=(()=>{let t={},e=document.getElementById("app"),n=document.createElement("div"),a=Object.entries(x),o=0,i="idle",s="",u=H();function l(r){s=r}function c(r){t=r}function f(r){i=r}function p(r,d){r.classList.add(`${$[d]}`)}function y(r){let d=r.dataset.cell.slice(0,1),m=+r.dataset.cell.slice(1,2),h=+r.dataset.cell.slice(2);return{x:m,y:h,gridRoot:d}}function _(r,d,m,h="add"){for(let C=0;C<d;C++){let X=`[data-cell="p${g.config.mainAxis==="x"?`${m.x}${m.y+C}`:`${m.x+C}${m.y}`}"]`;document.querySelectorAll(X).forEach(Z=>{Z.classList[h](r)})}}function k(r){let d=r.target;return d.classList.contains(`${$.gridItem}`)?y(d):void 0}function v(r){let d=k(r);if(!d)return;let{x:m,y:h}=d;if(!g.playerOne.getGameboard().validCoordinates(m,h,a[o][1])){_(`${$.cellInvalid}`,a[o][1],{x:m,y:h});return}r.type==="mouseover"?(_(`${$.cellInvalid}`,a[o][1],{x:m,y:h},"remove"),_(`${$.cellHover}`,a[o][1],{x:m,y:h})):_(`${$.cellHover}`,a[o][1],{x:m,y:h},"remove")}function G(){e.removeEventListener("mouseover",v),e.removeEventListener("mouseout",v),e.removeEventListener("mouseup",v)}function F(){o=o>3?0:o+1}function O({x:r,y:d}){let m={x:r,y:d,shipType:a[o][0]};t.notify(w,"placeship",m)}function R({x:r,y:d}){O({x:r,y:d}),_(`${$.cellShip}`,a[o][1],{x:r,y:d})}function U({x:r,y:d}){t.notify(w,"handleturn",{x:r,y:d})}function j(r,d,m){if(m!=="c"){if(!g.playerOne.getGameboard().validCoordinates(r,d,a[o][1]))return;R({x:r,y:d})}else O({x:r,y:d});F()}function T(r){let d=k(r);if(!d)return;let{x:m,y:h,gridRoot:C}=d;i==="gridConfig"?j(m,h,C):(U({x:m,y:h}),p(r.target,s),Se.notify(`${g.currentPlaying} fire a shot and... ${s==="misses"?s:"it's a hit!"}!`,s),g.currentPlaying==="Player"&&de(e,2500))}function Q(){e.addEventListener("mouseover",v),e.addEventListener("mouseup",v),e.addEventListener("mouseout",v),e.addEventListener("click",T)}function W(r){let d=b("div",{class:`${$.gridContainer}`}),m=new DocumentFragment;for(let h=0;h<r.getGameboard().grid.length;h++)for(let C=0;C<r.getGameboard().grid[h].length;C++){let L=b("div",{class:`${$.gridItem}`,"data-cell":`${r.getName()!=="cpu"?"p":"c"}${h}${C}`});m.appendChild(L)}return d.appendChild(m),d}function Y(r){return new Promise(d=>{let m=W(r),h=b("h2",{},r.getName()!=="cpu"?"Your Waters":"Enemy Waters"),C=b("section",{class:`${$.gridSection}`},[h,m]);r.getName()!=="cpu"&&(n=m),e==null||e.appendChild(C),d()})}function K(){let r=b("div",{class:`${$.modalAxis}`},`Axis: ${g.config.mainAxis}`),d=q("Rotate");d.addEvent("click",()=>{g.toggleAxis(),r.textContent=`Axis: ${g.config.mainAxis}`}),u.addItem([b("h2",{},[b("span",{class:`${$.modalTitle}`},"Place your ships")]),d.getButton(),r,n.cloneNode(!0)]),e==null||e.appendChild(u.getModal())}function z(){o=0,e.removeEventListener("click",T),e.innerHTML="",t.notify(w,"restart")}function J(){let r=H(),d=b("h2",{},`${g.playerOne.getName()} wins!`),m=q("Play again");m.addEvent("click",()=>{r.closeModal(),z()}),r.addItem([d,m.getButton()]),e==null||e.appendChild(r.getModal())}function V(){n.classList.add(`${$.gridContainerPlayer}`),u.closeModal(),G()}return{setGrid:Y,setupEvent:Q,openStartModal:K,setTurnResult:l,setMediator:c,setGamePhase:f,closeSetup:V,gameOverModal:J}})();class Me{constructor(e,n){S(this,"gameComponent");S(this,"domComponent");this.gameComponent=e,this.gameComponent.setMediator(this),this.domComponent=n,this.domComponent.setMediator(this)}notify(e,n,a){if(e===this.gameComponent&&(n==="makeui"&&this.domComponent.setGrid(e.getPlayerOne()).then(()=>{this.domComponent.setGrid(e.getPlayerTwo())}).then(()=>{this.gameComponent.getPlayerTwo().autoplace(),this.domComponent.openStartModal()}),n==="start"&&(this.domComponent.setupEvent(),this.domComponent.setGamePhase("gridConfig")),n==="turnPlayed"&&this.domComponent.setTurnResult(a),n==="startPlaying"&&(this.domComponent.setGamePhase("playing"),this.domComponent.closeSetup()),n==="gameover"&&this.domComponent.gameOverModal()),e===this.domComponent){if(n==="handleturn"){let{x:o,y:i}=a;this.gameComponent.handleTurn(o,i)}if(n==="placeship"){let{x:o,y:i,shipType:s}=a;this.gameComponent.addShip(+o,+i,s)}n==="restart"&&(this.gameComponent.reset(),this.gameComponent.start(),this.gameComponent.makeUI())}}}document.addEventListener("DOMContentLoaded",()=>{document.getElementById("mainsvg").style.display="block"});function Ee(){return new Promise(t=>{let e=b("div",{class:`${I.loader}`},[b("h1",{class:`${I.title}`},"Battleship")]);document.body.appendChild(e),setTimeout(()=>{t(e)},3e3)})}async function Ge(){const t=document.querySelector("#app"),e=await Ee();E.closeAnimation(e),t.classList.add(`${M.app}`),new Me(P,w),P.start(),P.makeUI()}Ge();
